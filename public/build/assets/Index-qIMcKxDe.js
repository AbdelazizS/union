import{r as n,q as K,j as e,$ as Q,m as p}from"./app-D5zgOKAD.js";import{t as o}from"./index-CDOhrpKr.js";import{B as O}from"./index-C8-8ZKTM.js";import{D as z}from"./data-table-xuiH6-jF.js";import{columns as G}from"./columns-Bgf_Z4Vj.js";import{u as D}from"./form-B0NGfjOj.js";import{s as q}from"./zod-CTB78kiI.js";import{o as J,n as u,b as C,s as F}from"./index-DWbN24nP.js";import{D as h,a as W,b as x,c as f,d as j,e as w,f as X}from"./dialog-sDPXERkU.js";import{ServiceOptionForm as E}from"./ServiceOptionForm-C2ldmGgU.js";import{L as Y}from"./AdminLayout-BQ9sENZH.js";import{P as Z}from"./plus-DHVrmD6B.js";import"./index-BBAzO_4d.js";import"./table-C18x9kzE.js";import"./input-D5FKwQjB.js";import"./select-DgOef9zO.js";import"./index-BSVezLny.js";import"./index-Crc4BVh8.js";import"./Combination-Cmb1a147.js";import"./tslib.es6-CmEaCU22.js";import"./index-BB6OtDRK.js";import"./index-DNxp1Wi1.js";import"./index-BKYgjeKX.js";import"./index-CrEWOBzh.js";import"./chevron-down-CztE_ilu.js";import"./createLucideIcon-AWgR876W.js";import"./check-BhB20Pym.js";import"./dropdown-menu-CixTnASt.js";import"./index-Cuq-Mmvq.js";import"./chevron-right-DKEmXFr0.js";import"./badge-DAUpYQro.js";import"./ellipsis-D87pnp6L.js";import"./eye-nL3GmjNe.js";import"./pencil-DUvomj0i.js";import"./trash-Dn0Y1l6S.js";import"./label-BHpa9F8K.js";import"./index-B6dbISNz.js";import"./x-DkObbUL-.js";import"./textarea-rFmGb7jf.js";import"./switch-CQMIwMOV.js";import"./separator-ZBq7OQqG.js";import"./sheet-CpllKNoK.js";import"./layers-ai9ES5Yn.js";import"./calendar-CP_I-VWs.js";import"./circle-help-DHWhEvao.js";import"./file-text-CyaKJaEx.js";import"./user-Ch48qi0I.js";const T=J({label:F().min(2,"Label must be at least 2 characters"),price:u().min(0,"Price must be positive"),min_qty:u().min(1,"Minimum quantity must be at least 1"),max_qty:u().min(1,"Maximum quantity must be at least 1").optional().nullable(),is_variable:C().default(!1),note:F().optional().nullable(),is_active:C().default(!0),sort_order:u().default(0)}),a={label:"",price:0,min_qty:1,max_qty:null,is_variable:!1,note:"",is_active:!0,sort_order:0};function Ge({service:l,options:A}){const[L,N]=n.useState(!1),[P,b]=n.useState(!1),[V,c]=n.useState(!1),[$,_]=n.useState(!1),[M,g]=n.useState(null),[s,y]=n.useState(null),[m,r]=n.useState(!1),{auth:ee}=K().props,v=D({resolver:q(T),defaultValues:a}),d=D({resolver:q(T),defaultValues:a}),S=()=>{p.reload({only:["options"]})},U=async t=>{r(!0);try{p.post(route("admin.services.options.store",l.id),t,{onSuccess:()=>{o.success("Service option created successfully"),N(!1),v.reset(a),S()},onError:i=>{console.log(i),o.error(i.message||"Something went wrong")},onFinish:()=>{r(!1)}})}catch{o.error("Something went wrong"),r(!1)}},k=async t=>{r(!0);try{p.put(route("admin.services.options.update",[l.id,M.id]),t,{onSuccess:()=>{o.success("Service option updated successfully"),b(!1),d.reset(a),g(null),S()},onError:i=>{console.error("Update error:",i),o.error(i.error||"Something went wrong")},onFinish:()=>{r(!1)}})}catch(i){console.error("Update error:",i),o.error("Something went wrong"),r(!1)}},B=t=>{g(t),d.reset({...t,price:Number(t.price),min_qty:Number(t.min_qty),max_qty:t.max_qty?Number(t.max_qty):null}),b(!0)},I=async t=>{r(!0);try{p.delete(route("admin.services.options.destroy",[l.id,t.id]),{onSuccess:()=>{o.success("Service option deleted successfully"),c(!1),y(null),S()},onError:i=>{o.error(i.message||"Something went wrong")},onFinish:()=>{r(!1)}})}catch{o.error("Something went wrong"),r(!1)}},R=t=>{y(t),_(!0)},H=t=>{y(t),c(!0)};return e.jsxs(Y,{children:[e.jsx(Q,{title:`${l.name} - Service Options`}),e.jsxs("div",{className:"container mx-auto py-10 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:l.name}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage service options and pricing"})]}),e.jsxs(h,{open:L,onOpenChange:t=>{t||v.reset(a),N(t)},children:[e.jsx(W,{asChild:!0,children:e.jsxs(O,{children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Add Option"]})}),e.jsxs(x,{className:"max-w-2xl",children:[e.jsxs(f,{children:[e.jsx(j,{children:"Add New Option"}),e.jsx(w,{children:"Fill in the details to create a new service option."})]}),e.jsx(E,{form:v,onSubmit:U,isSubmitting:m})]})]}),e.jsx(h,{open:P,onOpenChange:t=>{t||(d.reset(a),g(null)),b(t)},children:e.jsxs(x,{className:"max-w-2xl",children:[e.jsxs(f,{children:[e.jsx(j,{children:"Edit Option"}),e.jsx(w,{children:"Update the details of this service option."})]}),e.jsx(E,{form:d,onSubmit:k,isSubmitting:m})]})})]}),e.jsx(z,{columns:G(B,H,R),data:A,searchKey:"label"}),e.jsx(h,{open:V,onOpenChange:c,children:e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(j,{children:"Delete Option"}),e.jsx(w,{children:"Are you sure you want to delete this option? This action cannot be undone."})]}),e.jsxs(X,{children:[e.jsx(O,{variant:"outline",onClick:()=>c(!1),disabled:m,children:"Cancel"}),e.jsx(O,{variant:"destructive",onClick:()=>I(s),disabled:m,children:"Delete"})]})]})}),e.jsx(h,{open:$,onOpenChange:_,children:e.jsxs(x,{className:"max-w-2xl",children:[e.jsx(f,{children:e.jsx(j,{children:"Option Details"})}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Label"}),e.jsx("p",{children:s.label})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Price"}),e.jsxs("p",{children:["Â£",Number(s.price).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Quantity Range"}),e.jsxs("p",{children:[s.min_qty,s.max_qty?` - ${s.max_qty}`:"+",s.is_variable?" (Variable)":" (Fixed)"]})]}),s.note&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Note"}),e.jsx("p",{children:s.note})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Status"}),e.jsx("p",{children:s.is_active?"Active":"Inactive"})]})]})]})})]})]})}export{Ge as default};
