import{r as S,j as e,m as j}from"./app-DN1qyw_4.js";import{u as $}from"./index.esm-BKbCLyPq.js";import{s as A,o as V,a as u,e as M,c as O,d as U}from"./index-BezgtxjW.js";import{t as h}from"./index-COa0dWTm.js";import{B as v,c as w}from"./index-LX2bqK-N.js";import{P as L,a as R,b as W,C as z,c as G}from"./popover-BBU7GkUU.js";import{F as H,a as d,b as l,c as t,d as m,e as a,f as J}from"./form-CdwVkoaf.js";import{I as p}from"./input-DGoI5Joj.js";import{S as P,a as F,b as q,c as B,d as f}from"./select-FtBAXfob.js";import{T as I}from"./textarea-BY2Wfk79.js";import{C as _,a as b}from"./card-B1emr2ze.js";import{S as g}from"./separator-CvwyiO9a.js";import{C as K}from"./calendar-CNUueBHR.js";import{C as Q}from"./clock-Dctz3bie.js";import{f as X}from"./format-SmSpYad1.js";import"./index-BbdZmysQ.js";import"./chevron-right-DqXEnUok.js";import"./createLucideIcon-BpMd3PhH.js";import"./chevron-left-CW_H48r7.js";import"./index-BMWwzzsh.js";import"./Combination-CFYBKmqt.js";import"./tslib.es6-BUas5LQb.js";import"./index-DHYjMWsS.js";import"./index-RM6Jqcin.js";import"./index-D7fmTsiv.js";import"./label-tZuXtweX.js";import"./index-BAOtmrvp.js";import"./index-DN810jkT.js";import"./index-qC52FuWJ.js";import"./chevron-down-DHOMMINn.js";import"./check-BX_ytt3u.js";const Y=V({service_id:u().min(1,"Service is required"),booking_date:U({required_error:"Booking date is required"}),duration_hours:O.number().min(1,"Duration must be at least 1 hour"),frequency:M(["one_time","weekly","biweekly","monthly"],{required_error:"Please select a frequency"}),customer_name:u().min(2,"Name must be at least 2 characters"),customer_email:u().email("Invalid email address"),customer_phone:u().min(10,"Phone number must be at least 10 digits"),customer_address:u().min(5,"Address must be at least 5 characters"),notes:u().optional(),coupon_code:u().optional()});function qe({services:T,initialData:s=null,isEdit:y=!1}){var C;const[k,N]=S.useState(!1),[n,Z]=S.useState(null),o=$({resolver:A(Y),defaultValues:{service_id:s!=null&&s.service_id?String(s.service_id):"",booking_date:s!=null&&s.booking_date?new Date(s.booking_date):new Date,duration_hours:(s==null?void 0:s.duration_hours)||1,frequency:(s==null?void 0:s.frequency)||"one_time",customer_name:(s==null?void 0:s.customer_name)||"",customer_email:(s==null?void 0:s.customer_email)||"",customer_phone:(s==null?void 0:s.customer_phone)||"",customer_address:(s==null?void 0:s.customer_address)||"",notes:(s==null?void 0:s.notes)||"",coupon_code:((C=s==null?void 0:s.coupon)==null?void 0:C.code)||""}}),E=async r=>{N(!0);try{const c={...r,booking_date:G(r.booking_date,1)};y?await j.patch(route("admin.bookings.update",s.id),c,{onSuccess:()=>{h.success("Booking updated successfully"),j.visit(route("admin.bookings.index"))},onError:x=>{Object.keys(x).forEach(i=>{o.setError(i,{message:x[i]})}),h.error("Please check the form for errors")}}):await j.post(route("admin.bookings.store"),c,{onSuccess:()=>{h.success("Booking created successfully"),j.visit(route("admin.bookings.index"))},onError:x=>{Object.keys(x).forEach(i=>{o.setError(i,{message:x[i]})}),h.error("Please check the form for errors")}})}catch(c){console.error("Error submitting form:",c),h.error("An error occurred while saving the booking")}finally{N(!1)}};return e.jsx(H,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(E),className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-8 md:grid-cols-2",children:[e.jsx(_,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Service Details"}),e.jsx(g,{}),e.jsx(d,{control:o.control,name:"service_id",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Service"}),e.jsxs(P,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(m,{children:e.jsx(F,{children:e.jsx(q,{placeholder:"Select a service"})})}),e.jsx(B,{children:T.map(c=>e.jsx(f,{value:String(c.id),children:c.name},c.id))})]}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"booking_date",render:({field:r})=>e.jsxs(l,{className:"flex flex-col",children:[e.jsx(t,{children:"Booking Date"}),e.jsxs(L,{children:[e.jsx(R,{asChild:!0,children:e.jsx(m,{children:e.jsxs(v,{variant:"outline",className:w("w-full pl-3 text-left font-normal",!r.value&&"text-muted-foreground"),children:[r.value?X(r.value,"PPP"):e.jsx("span",{children:"Pick a date"}),e.jsx(K,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(W,{className:"w-auto p-0",align:"start",children:e.jsx(z,{mode:"single",selected:r.value,onSelect:r.onChange,disabled:c=>c<new Date||c<new Date("1900-01-01"),initialFocus:!0})})]}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"duration_hours",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Duration (hours)"}),e.jsx(m,{children:e.jsx(p,{type:"number",min:1,...r,onChange:c=>r.onChange(parseInt(c.target.value))})}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"frequency",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Frequency"}),e.jsxs(P,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(m,{children:e.jsx(F,{children:e.jsx(q,{placeholder:"Select frequency"})})}),e.jsxs(B,{children:[e.jsx(f,{value:"one_time",children:"One Time"}),e.jsx(f,{value:"weekly",children:"Weekly"}),e.jsx(f,{value:"biweekly",children:"Bi-weekly"}),e.jsx(f,{value:"monthly",children:"Monthly"})]})]}),e.jsx(a,{})]})})]})})}),e.jsx(_,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Customer Information"}),e.jsx(g,{}),e.jsx(d,{control:o.control,name:"customer_name",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Name"}),e.jsx(m,{children:e.jsx(p,{...r})}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"customer_email",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Email"}),e.jsx(m,{children:e.jsx(p,{type:"email",...r})}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"customer_phone",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Phone"}),e.jsx(m,{children:e.jsx(p,{type:"tel",...r})}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"customer_address",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Address"}),e.jsx(m,{children:e.jsx(I,{...r})}),e.jsx(a,{})]})})]})})})]}),e.jsx(_,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Additional Information"}),e.jsx(g,{}),e.jsx(d,{control:o.control,name:"notes",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Notes"}),e.jsx(m,{children:e.jsx(I,{...r})}),e.jsx(J,{children:"Any special instructions or requirements"}),e.jsx(a,{})]})}),e.jsx(d,{control:o.control,name:"coupon_code",render:({field:r})=>e.jsxs(l,{children:[e.jsx(t,{children:"Coupon Code"}),e.jsx(m,{children:e.jsx(p,{...r})}),e.jsx(a,{})]})})]})})}),n&&e.jsx(_,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Price Breakdown"}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Base Price:"}),e.jsxs("span",{children:["$",n.base_amount]})]}),n.frequency_discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Frequency Discount:"}),e.jsxs("span",{children:["-$",n.frequency_discount]})]}),n.bulk_discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Bulk Discount:"}),e.jsxs("span",{children:["-$",n.bulk_discount]})]}),n.coupon_discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Coupon Discount:"}),e.jsxs("span",{children:["-$",n.coupon_discount]})]}),n.special_period_adjustment!==0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Special Period Adjustment:"}),e.jsxs("span",{className:w(n.special_period_adjustment>0?"text-red-600":"text-green-600"),children:[n.special_period_adjustment>0?"+":"-","$",Math.abs(n.special_period_adjustment)]})]}),e.jsx(g,{}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Final Price:"}),e.jsxs("span",{children:["$",n.final_amount]})]})]})]})})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>j.visit(route("admin.bookings.index")),children:"Cancel"}),e.jsx(v,{type:"submit",disabled:k,children:k?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4 animate-spin"}),y?"Updating...":"Creating..."]}):y?"Update Booking":"Create Booking"})]})]})})}export{qe as BookingForm};
