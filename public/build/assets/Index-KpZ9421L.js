import{r as i,j as e,$ as H,m as h}from"./app-D5zgOKAD.js";import{t as a}from"./index-CDOhrpKr.js";import{B as v}from"./index-C8-8ZKTM.js";import{D as K}from"./data-table-xuiH6-jF.js";import{columns as R}from"./columns-De4Lkm5S.js";import{u as T}from"./form-B0NGfjOj.js";import{s as A}from"./zod-CTB78kiI.js";import{o as X,u as Y,s as C,i as Z}from"./index-DWbN24nP.js";import{D as x,a as q,b as f,c as j,d as w,e as E,f as J}from"./dialog-sDPXERkU.js";import{PartnerForm as _}from"./PartnerForm-DK2gxD3K.js";import{L as Q}from"./AdminLayout-BQ9sENZH.js";import{C as ee,a as se}from"./card-BKGLJ8p-.js";import{P as te}from"./plus-DHVrmD6B.js";import"./index-BBAzO_4d.js";import"./table-C18x9kzE.js";import"./input-D5FKwQjB.js";import"./select-DgOef9zO.js";import"./index-BSVezLny.js";import"./index-Crc4BVh8.js";import"./Combination-Cmb1a147.js";import"./tslib.es6-CmEaCU22.js";import"./index-BB6OtDRK.js";import"./index-DNxp1Wi1.js";import"./index-BKYgjeKX.js";import"./index-CrEWOBzh.js";import"./chevron-down-CztE_ilu.js";import"./createLucideIcon-AWgR876W.js";import"./check-BhB20Pym.js";import"./dropdown-menu-CixTnASt.js";import"./index-Cuq-Mmvq.js";import"./chevron-right-DKEmXFr0.js";import"./ellipsis-D87pnp6L.js";import"./eye-nL3GmjNe.js";import"./pencil-DUvomj0i.js";import"./trash-Dn0Y1l6S.js";import"./label-BHpa9F8K.js";import"./index-B6dbISNz.js";import"./x-DkObbUL-.js";import"./image-upload-DB-EMDCR.js";import"./index-D8untdAM.js";import"./separator-ZBq7OQqG.js";import"./sheet-CpllKNoK.js";import"./layers-ai9ES5Yn.js";import"./calendar-CP_I-VWs.js";import"./circle-help-DHWhEvao.js";import"./file-text-CyaKJaEx.js";import"./user-Ch48qi0I.js";const oe=5*1024*1024,re=["image/jpeg","image/jpg","image/png","image/webp"],L=X({name:C().min(2,"Name must be at least 2 characters"),logo:Y([Z(File).refine(o=>(o==null?void 0:o.size)<=oe,"Max file size is 5MB.").refine(o=>re.includes(o==null?void 0:o.type),"Only .jpg, .jpeg, .png and .webp formats are supported."),C().url().optional(),C().optional()]).optional().nullable()}),m={name:"",logo:null};function Je({partners:o}){const[I,F]=i.useState(!1),[M,y]=i.useState(!1),[V,p]=i.useState(!1),[k,O]=i.useState(!1),[d,b]=i.useState(null),[l,S]=i.useState(null),[u,r]=i.useState(!1),D=T({resolver:A(L),defaultValues:m}),g=T({resolver:A(L),defaultValues:m}),N=()=>{h.reload({only:["partners"]})},B=async s=>{r(!0);const t=new FormData;if(t.append("name",s.name),s.logo){if(s.logo instanceof File)t.append("logo",s.logo);else if(typeof s.logo=="string"&&s.logo.startsWith("data:")){const c=await(await fetch(s.logo)).blob(),P=new File([c],"logo.png",{type:c.type});t.append("logo",P)}}try{h.post("/admin/partners",t,{onSuccess:()=>{a.success("Partner created successfully"),F(!1),D.reset(m),N()},onError:n=>{console.error(n),a.error(n.message||"Something went wrong")},onFinish:()=>{r(!1)}})}catch{a.error("Something went wrong"),r(!1)}},$=async s=>{r(!0);const t=new FormData;if(t.append("_method","PUT"),t.append("name",s.name),s.logo){if(s.logo instanceof File)t.append("logo",s.logo);else if(typeof s.logo=="string"&&s.logo.startsWith("data:")){const c=await(await fetch(s.logo)).blob(),P=new File([c],"logo.png",{type:c.type});t.append("logo",P)}}try{h.post(`/admin/partners/${d.id}`,t,{onSuccess:()=>{a.success("Partner updated successfully"),y(!1),g.reset(m),b(null),N()},onError:n=>{console.error(n),a.error(n.message||"Something went wrong")},onFinish:()=>{r(!1)}})}catch{a.error("Something went wrong"),r(!1)}},z=s=>{b(s),g.reset({name:s.name,logo:null}),y(!0)},U=async s=>{r(!0);try{h.delete(route("admin.partners.destroy",s.id),{onSuccess:()=>{a.success("Partner deleted successfully"),p(!1),S(null),N()},onError:t=>{a.error(t.message||"Something went wrong")},onFinish:()=>{r(!1)}})}catch{a.error("Something went wrong"),r(!1)}},W=s=>{S(s),O(!0)},G=s=>{S(s),p(!0)};return e.jsxs(Q,{children:[e.jsx(H,{title:"Partners"}),e.jsxs("div",{className:"container mx-auto py-10 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Partners"}),e.jsxs(x,{open:I,onOpenChange:s=>{s||D.reset(m),F(s)},children:[e.jsx(q,{asChild:!0,children:e.jsxs(v,{children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Add Partner"]})}),e.jsxs(f,{className:"max-w-2xl",children:[e.jsxs(j,{children:[e.jsx(w,{children:"Add New Partner"}),e.jsx(E,{children:"Add a new partner to your cleaning service network."})]}),e.jsx(_,{form:D,onSubmit:B,isSubmitting:u})]})]}),e.jsx(x,{open:M,onOpenChange:s=>{s||(g.reset(m),b(null)),y(s)},children:e.jsxs(f,{className:"max-w-2xl",children:[e.jsxs(j,{children:[e.jsx(w,{children:"Edit Partner"}),e.jsx(E,{children:"Update the partner's information."})]}),e.jsx(_,{form:g,onSubmit:$,isSubmitting:u,isEditing:!0,currentLogo:d==null?void 0:d.logo_path})]})})]}),e.jsx(ee,{children:e.jsx(se,{className:"p-0",children:e.jsx(K,{columns:R(z,G,W),data:o,searchKey:"name"})})}),e.jsx(x,{open:V,onOpenChange:p,children:e.jsxs(f,{children:[e.jsxs(j,{children:[e.jsx(w,{children:"Delete Partner"}),e.jsx(E,{children:"Are you sure you want to delete this partner? This action cannot be undone."})]}),e.jsxs(J,{children:[e.jsx(v,{variant:"outline",onClick:()=>p(!1),disabled:u,children:"Cancel"}),e.jsx(v,{variant:"destructive",onClick:()=>U(l),disabled:u,children:"Delete"})]})]})}),e.jsx(x,{open:k,onOpenChange:O,children:e.jsxs(f,{className:"max-w-2xl",children:[e.jsx(j,{children:e.jsx(w,{children:"View Partner Details"})}),l&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium leading-none text-muted-foreground",children:"Logo"}),e.jsx("div",{className:"h-40 w-40 relative rounded-lg overflow-hidden border",children:e.jsx("img",{src:l.logo_path,alt:l.name,className:"object-contain w-full h-full"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium leading-none text-muted-foreground",children:"Name"}),e.jsx("p",{className:"text-base font-medium",children:l.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium leading-none text-muted-foreground",children:"Slug"}),e.jsx("p",{className:"text-sm font-mono bg-muted p-2 rounded",children:l.slug})]})]})})]})})]})]})}export{Je as default};
