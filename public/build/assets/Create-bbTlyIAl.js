import{r as o,j as e,a as I,$ as L,m as M}from"./app-D5zgOKAD.js";import{u as O,F as W,a as c,b as d,c as m,d as x,e as u}from"./form-B0NGfjOj.js";import{s as Y}from"./zod-CTB78kiI.js";import{o as k,s as p,d as z,a as G,n as H}from"./index-DWbN24nP.js";import{W as J,m as K,S as Q}from"./WebsiteLayout-DRrtWhni.js";import{c as g,e as U,B as P}from"./index-C8-8ZKTM.js";import{I as h}from"./input-D5FKwQjB.js";import{L as F}from"./label-BHpa9F8K.js";import{S as X,a as Z,b as ee,c as se,d as te}from"./select-DgOef9zO.js";import{P as ae,a as re,b as ie,C as oe}from"./popover-CYbGzW0S.js";import{T}from"./textarea-rFmGb7jf.js";import{C as V,a as A}from"./card-BKGLJ8p-.js";import{C as ne}from"./checkbox-Dba-AV0K.js";import{C as le}from"./calendar-CP_I-VWs.js";import{T as ce}from"./tag-DL5krDDT.js";import{C as de}from"./circle-check-CobA_xOl.js";import{A as me}from"./arrow-right-BxspscqD.js";import{f as D}from"./format-SmSpYad1.js";import"./sheet-CpllKNoK.js";import"./index-B6dbISNz.js";import"./index-BSVezLny.js";import"./Combination-Cmb1a147.js";import"./index-BBAzO_4d.js";import"./tslib.es6-CmEaCU22.js";import"./index-Cuq-Mmvq.js";import"./x-DkObbUL-.js";import"./createLucideIcon-AWgR876W.js";import"./phone-DJg7fU2z.js";import"./index-D8untdAM.js";import"./index-Crc4BVh8.js";import"./index-BB6OtDRK.js";import"./index-DNxp1Wi1.js";import"./index-BKYgjeKX.js";import"./index-CrEWOBzh.js";import"./chevron-down-CztE_ilu.js";import"./check-BhB20Pym.js";import"./chevron-right-DKEmXFr0.js";import"./chevron-left-AmoEll6X.js";const xe=U("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),E=o.forwardRef(({className:l,variant:n,...i},f)=>e.jsx("div",{ref:f,role:"alert",className:g(xe({variant:n}),l),...i}));E.displayName="Alert";const ue=o.forwardRef(({className:l,...n},i)=>e.jsx("h5",{ref:i,className:g("mb-1 font-medium leading-none tracking-tight",l),...n}));ue.displayName="AlertTitle";const q=o.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:g("text-sm [&_p]:leading-relaxed",l),...n}));q.displayName="AlertDescription";const pe=k({service_id:p().min(1,"Please select a service"),selected_options:G(k({option_id:p(),quantity:H().optional()})).min(1,"Please select at least one option"),booking_date:z({required_error:"Please select a date",invalid_type_error:"That's not a valid date"}),customer_name:p().min(2,"Name must be at least 2 characters").max(100,"Name cannot exceed 100 characters"),customer_email:p().email("Please enter a valid email address"),customer_phone:p().min(10,"Phone number must be at least 10 digits").max(20,"Phone number cannot exceed 20 digits"),customer_address:p().min(5,"Address must be at least 5 characters").max(200,"Address cannot exceed 200 characters"),notes:p().max(500,"Notes cannot exceed 500 characters").optional(),coupon_code:p().max(50,"Coupon code cannot exceed 50 characters").optional()});function es({services:l,selectedServiceId:n}){const[i,f]=o.useState(null),[he,b]=o.useState(!1),[N,y]=o.useState(null),[w,S]=o.useState(!1),[C,B]=o.useState(null),t=O({resolver:Y(pe),defaultValues:{service_id:(n==null?void 0:n.toString())||"",selected_options:[],booking_date:new Date,customer_name:"",customer_email:"",customer_phone:"",customer_address:"",notes:"",coupon_code:""}});o.useEffect(()=>{if(t.watch("service_id")){const s=l.find(a=>a.id.toString()===t.watch("service_id"));B(s)}},[t.watch("service_id")]),o.useEffect(()=>{t.watch("service_id")&&t.watch("selected_options").length>0&&R()},[t.watch("service_id"),t.watch("selected_options"),t.watch("coupon_code")]);const R=async()=>{var s,a;b(!0),y(null);try{const r=await I.post(route("website.booking.calculate-price"),{service_id:t.getValues("service_id"),selected_options:t.getValues("selected_options"),coupon_code:t.getValues("coupon_code")});f(r.data)}catch(r){y(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to calculate price")}finally{b(!1)}},$=s=>{M.post(route("website.booking.store"),{...s,booking_date:D(s.booking_date,"yyyy-MM-dd")},{onStart:()=>S(!0),onFinish:()=>S(!1),onError:a=>{}})};return e.jsxs(J,{children:[e.jsx(L,{title:"Book Service"}),e.jsx("div",{className:"min-h-screen bg-background py-20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs(K.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-extrabold tracking-tight mb-4",children:"Book Your Service"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Fill out the form below to schedule your service appointment"})]}),e.jsx(W,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit($),className:"space-y-8",children:[e.jsx(V,{children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Q,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-2xl font-semibold",children:"Service Details"})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx(c,{control:t.control,name:"service_id",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Select Service"}),e.jsxs(X,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(x,{children:e.jsx(Z,{children:e.jsx(ee,{placeholder:"Choose a service"})})}),e.jsx(se,{children:l.map(a=>e.jsx(te,{value:a.id.toString(),children:a.name},a.id))})]}),e.jsx(u,{})]})}),C&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{children:"Service Options"}),e.jsx("div",{className:"grid gap-4",children:C.options.map(s=>{var a;return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ne,{id:`option-${s.id}`,checked:t.watch("selected_options").some(r=>r.option_id===s.id.toString()),onCheckedChange:r=>{const j=t.getValues("selected_options");r?t.setValue("selected_options",[...j,{option_id:s.id.toString(),quantity:s.is_variable?1:void 0}]):t.setValue("selected_options",j.filter(v=>v.option_id!==s.id.toString()))}}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsxs(F,{htmlFor:`option-${s.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[s.label," - £",s.price,s.is_variable&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ","(per unit)"]})]}),s.note&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.note}),s.is_variable&&t.watch("selected_options").some(r=>r.option_id===s.id.toString())&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{type:"number",min:s.min_qty||1,max:s.max_qty,value:((a=t.watch("selected_options").find(r=>r.option_id===s.id.toString()))==null?void 0:a.quantity)||1,onChange:r=>{const j=parseInt(r.target.value),v=t.getValues("selected_options");t.setValue("selected_options",v.map(_=>_.option_id===s.id.toString()?{..._,quantity:j}:_))},className:"w-20"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"units"})]})]})]},s.id)})})]}),e.jsx(c,{control:t.control,name:"booking_date",render:({field:s})=>e.jsxs(d,{className:"flex flex-col",children:[e.jsx(m,{children:"Preferred Date"}),e.jsxs(ae,{children:[e.jsx(re,{asChild:!0,children:e.jsx(x,{children:e.jsxs(P,{variant:"outline",className:g("w-full pl-3 text-left font-normal",!s.value&&"text-muted-foreground"),children:[s.value?D(s.value,"PPP"):e.jsx("span",{children:"Pick a date"}),e.jsx(le,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(ie,{className:"w-auto p-0",align:"start",children:e.jsx(oe,{mode:"single",selected:s.value,onSelect:s.onChange,disabled:a=>a<new Date,initialFocus:!0})})]}),e.jsx(u,{})]})}),e.jsx(c,{control:t.control,name:"coupon_code",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Coupon Code"}),e.jsx(x,{children:e.jsxs("div",{className:"relative",children:[e.jsx(h,{...s,placeholder:"Enter coupon code"}),e.jsx(ce,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"})]})}),e.jsx(u,{})]})}),i&&e.jsxs("div",{className:"bg-primary/5 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Base Price:"}),e.jsxs("span",{children:["£",i.base_amount]})]}),i.discount_amount>0&&e.jsxs("div",{className:"flex justify-between items-center text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-£",i.discount_amount]})]}),e.jsxs("div",{className:"flex justify-between items-center font-semibold border-t pt-2",children:[e.jsx("span",{children:"Final Price:"}),e.jsxs("span",{children:["£",i.final_amount]})]})]})]})]})})}),e.jsx(V,{children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(de,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-2xl font-semibold",children:"Your Information"})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsx(c,{control:t.control,name:"customer_name",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Full Name"}),e.jsx(x,{children:e.jsx(h,{...s})}),e.jsx(u,{})]})}),e.jsx(c,{control:t.control,name:"customer_email",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Email"}),e.jsx(x,{children:e.jsx(h,{...s,type:"email"})}),e.jsx(u,{})]})})]}),e.jsx(c,{control:t.control,name:"customer_phone",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Phone Number"}),e.jsx(x,{children:e.jsx(h,{...s})}),e.jsx(u,{})]})}),e.jsx(c,{control:t.control,name:"customer_address",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Address"}),e.jsx(x,{children:e.jsx(T,{...s,rows:3})}),e.jsx(u,{})]})}),e.jsx(c,{control:t.control,name:"notes",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{children:"Additional Notes"}),e.jsx(x,{children:e.jsx(T,{...s,rows:3,placeholder:"Any special requirements or instructions?"})}),e.jsx(u,{})]})})]})]})})}),N&&e.jsx(E,{variant:"destructive",children:e.jsx(q,{children:N})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(P,{type:"submit",size:"lg",disabled:w,className:"rounded-full bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70",children:[w?"Processing...":"Book Now",e.jsx(me,{className:"ml-2 h-5 w-5"})]})})]})})]})})})]})}export{es as default};
